<section class="content-header">
  <h1>Crear venta</h1>

  <ol class="breadcrumb">
    <li>
      <a [routerLink]="['/dashboard/inicio']"
        ><i class="fa fa-dashboard"></i> Inicio</a
      >
    </li>

    <li class="active">Crear venta</li>
  </ol>
</section>

<section class="content">
  <div class="row">
    <!--=====================================
        EL FORMULARIO
        ======================================-->

    <div class="col-lg-5 col-xs-12">
      <div class="box box-success">
        <div class="box-header with-border"></div>

        <form role="form" [formGroup]="formVenta">
          <div class="box-body">
            <div class="box">
              <!--=====================================
                  ENTRADA DEL CLIENTE
                  ======================================-->

              <!-- <div class="form-group">
                    
                    <div class="input-group">
                      
                      <span class="input-group-addon"><i class="fa fa-users"></i></span>
                      
                      <select class="form-control" id="seleccionarCliente" name="seleccionarCliente" required>
  
                      <option value="">Seleccionar cliente</option>
  
                      </select>
                      
                      <span class="input-group-addon"><button type="button" class="btn btn-default btn-xs" data-toggle="modal" data-target="#modalAgregarCliente" data-dismiss="modal">Agregar cliente</button></span>
                    
                    </div>
                  
                  </div> -->

              <!--=====================================
                  ENTRADA DEL VENDEDOR
                  ======================================-->

              <div class="form-group">
                <div class="input-group">
                  <!-- <span class="input-group-addon"><i class="fa fa-user"></i></span>  -->
                  <span class="input-group-addon"
                    ><i class="fa fa-users"></i
                  ></span>

                  <input
                    type="text"
                    class="form-control"
                    formControlName="cliente"
                    readonly
                  />
                </div>
              </div>

              <!--=====================================
                  ENTRADA DEL VENDEDOR
                  ======================================-->

              <div class="form-group">
                <div class="input-group">
                  <span class="input-group-addon"
                    ><i class="fa fa-key"></i
                  ></span>

                  <input
                    type="text"
                    class="form-control"
                    id="nuevaVenta"
                    formControlName="documento"
                    readonly
                  />
                </div>
              </div>

              <!--=====================================
                  ENTRADA PARA AGREGAR PRODUCTO
                  ======================================-->

              <div>
                <div
                  class="form-group row nuevoProducto"
                  *ngFor="let item of productosPedido; let i = index"
                >
                  <!-- Descripción del producto -->

                  <div class="col-xs-6" style="padding-right: 0px">
                    <div class="input-group">
                      <span class="input-group-addon"
                        ><button type="button" class="btn btn-danger btn-xs"  (click)="deleteProduct(item)" >
                          <i class="fa fa-times"></i></button
                      ></span>

                      <input
                        type="text"
                        class="form-control"
                        [value]="item.descripcion"
                        readonly
                        id="agregarProducto"
                        placeholder="Descripción del producto"
                        required
                      />
                    </div>
                  </div>

                  <!-- Cantidad del producto -->

                  <div class="col-xs-2">
                    <input
                      type="number"
                      readonly
                      class="form-control"
                      [value]="item.cantidad"
                      id="nuevaCantidadProducto"
                      min="1"
                      placeholder="0"
                      required
                    />
                  </div>

                  <!-- Precio del producto -->

                  <div class="col-xs-2" style="padding-left: 0px">
                    <div class="input-group">
                      <span class="input-group-addon"
                        ><i class="ion ion-social-usd"></i
                      ></span>

                      <input
                        type="number"
                        min="1"
                        class="form-control"
                        id="nuevoPrecioProducto"
                        placeholder="000000"
                        [value]="item.precio"
                        readonly
                        required
                      />
                    </div>
                  </div>

                  <!-- Total -->
                  <div class="col-xs-2" style="padding-left: 0px">
                    <div class="input-group">
                      <span class="input-group-addon"
                        ><i class="ion ion-social-usd"></i
                      ></span>

                      <input
                        type="number"
                        min="1"
                        class="form-control"
                        id="nuevoPrecioProducto"
                        placeholder="000000"
                        [value]="item.total"
                        readonly
                        required
                      />
                    </div>
                  </div>
                </div>
              </div>

              <!--=====================================
                  BOTÓN PARA AGREGAR PRODUCTO
                  ======================================-->

              <button type="button" class="btn btn-default hidden-lg">
                Agregar producto
              </button>

              <hr />

              <div class="row">
                <!--=====================================
                    ENTRADA IMPUESTOS Y TOTAL
                    ======================================-->

                <div class="col-xs-8 pull-right">
                  <table class="table">
                    <thead>
                      <tr>
                        <th>Impuesto</th>
                        <th>Total</th>
                      </tr>
                    </thead>

                    <tbody>
                      <tr>
                        <td style="width: 50%">
                          <div class="input-group">
                            <input
                              type="number"
                              class="form-control"
                              min="0"
                              id="nuevoImpuestoVenta"
                              placeholder="0"
                              formControlName="impuesto"
                              required
                            />
                            <span class="input-group-addon"
                              ><i class="fa fa-percent"></i
                            ></span>
                          </div>
                        </td>

                        <td style="width: 50%">
                          <div class="input-group">
                            <span class="input-group-addon"
                              ><i class="ion ion-social-usd"></i
                            ></span>

                            <input
                              type="number"
                              min="1"
                              class="form-control"
                              id="nuevoTotalVenta"
                              placeholder="00000"
                              formControlName="total"
                              readonly
                              required
                            />
                          </div>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>

              <hr />

              <!--=====================================
                  ENTRADA MÉTODO DE PAGO
                  ======================================-->

              <div class="form-group row">
                <div class="col-xs-6" style="padding-right: 0px">
                  <div class="input-group">
                    <select
                      class="form-control"
                      id="nuevoMetodoPago"
                      formControlName="metodoPago"
                      required
                    >
                      <option [value]="metodo.id" *ngFor="let metodo of metodoPagoList">{{metodo.nombre}} </option>
                    </select>
                  </div>
                </div>

                <div class="col-xs-6" style="padding-left: 0px">
                  <div class="input-group">
                    <input
                      type="text"
                      class="form-control"
                      id="nuevoCodigoTransaccion"
                      formControlName="codigoTransaccion"
                      placeholder="Código transacción"
                      required
                    />

                    <span class="input-group-addon"
                      ><i class="fa fa-lock"></i
                    ></span>
                  </div>
                </div>
              </div>

              <br />
            </div>
          </div>

          <div class="box-footer">
            <button type="button" (click)="saveVenta()"  class="btn btn-primary pull-right">
              Guardar venta
            </button>
          </div>
        </form>
      </div>
    </div>

    <!--=====================================
        LA TABLA DE PRODUCTOS
        ======================================-->

    <div class="col-lg-7 hidden-md hidden-sm hidden-xs">
      <div class="box box-warning">
        <div class="box-header with-border"></div>

        <div class="box-body">
          <table
            class="table table-bordered table-striped dt-responsive tablas"
          >
            <thead>
              <tr>
                <th style="width: 10px">#</th>
                <th>Imagen</th>
                <th>Código</th>
                <th>Descripcion</th>
                <th>Stock</th>
                <!-- <th>Acciones</th> -->
              </tr>
            </thead>

            <tbody>
              <tr *ngFor="let pro of productoTabla; index as i"  > 
                <td> {{i+1}}</td>
                <td>
                  <!-- ./../../../assets/img/productos/default/anonymous.png -->
                  <img
                    [src]="pro.imagen? pro.imagen : './../../../assets/img/productos/default/anonymous.png'"
                    class="img-thumbnail"
                    width="40px"
                  />
                </td>
                <td>{{pro.codigo}}</td>
                <td>{{pro.descripcion}}</td>
                <td>{{pro.stock}}</td>
                <!-- <td>
                  <div class="btn-group">
                    <button type="button" class="btn btn-primary">
                      Agregar
                    </button>
                  </div>
                </td> -->
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</section>

<!--=====================================
  MODAL AGREGAR CLIENTE
  ======================================-->

<div id="modalAgregarCliente" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <form [formGroup]="validacionClientes" #cuentaForm="ngForm">
        <!--=====================================
            CABEZA DEL MODAL
            ======================================-->

        <div class="modal-header" style="background: #3c8dbc; color: white">
          <button type="button" class="close" data-dismiss="modal">
            &times;
          </button>

          <h4 class="modal-title">Agregar cliente</h4>
        </div>

        <!--=====================================
            CUERPO DEL MODAL
            ======================================-->

        <div class="modal-body">
          <div class="box-body">
            <!-- ENTRADA PARA EL NOMBRE -->

            <div class="form-group">
              <div class="input-group">
                <span class="input-group-addon"
                  ><i class="fa fa-user"></i
                ></span>

                <input
                  type="text"
                  class="form-control input-lg"
                  formControlName="nuevoCliente"
                  placeholder="Ingresar nombre"
                />
              </div>
              <div
                *ngIf="
                  validacionClientes.controls['nuevoCliente'].invalid &&
                  (validacionClientes.controls['nuevoCliente'].dirty ||
                    validacionClientes.controls['nuevoCliente'].touched)
                "
                class="form-text text-danger"
              >
                <div
                  *ngFor="
                    let validation of user_validation_messages.nuevoCliente
                  "
                >
                  <div
                    style="font-size: smaller !important"
                    *ngIf="
                      validacionClientes
                        .get('nuevoCliente')
                        ?.hasError(validation.type) &&
                      (validacionClientes.get('nuevoCliente')?.dirty ||
                        validacionClientes.get('nuevoCliente')?.touched)
                    "
                  >
                    {{ validation.message }}
                  </div>
                </div>
              </div>
              <small
                *ngIf="nuevoClienteNoValido"
                class="form-text text-danger animate__animated animate__heartBeat"
              ></small>
            </div>

            <!-- ENTRADA PARA EL DOCUMENTO ID -->

            <div class="form-group">
              <div class="input-group">
                <span class="input-group-addon"><i class="fa fa-key"></i></span>

                <input
                  type="text"
                  class="form-control input-lg"
                  formControlName="nuevoDocumentoId"
                  placeholder="Ingresar documento"
                  maxlength="13"
                  minlength="10"
                />
              </div>
              <div
                *ngIf="
                  validacionClientes.controls['nuevoDocumentoId'].invalid &&
                  (validacionClientes.controls['nuevoDocumentoId'].dirty ||
                    validacionClientes.controls['nuevoDocumentoId'].touched)
                "
                class="form-text text-danger"
              >
                <div
                  *ngFor="
                    let validation of user_validation_messages.nuevoCliente
                  "
                >
                  <div
                    style="font-size: smaller !important"
                    *ngIf="
                      validacionClientes
                        .get('nuevoDocumentoId')
                        ?.hasError(validation.type) &&
                      (validacionClientes.get('nuevoDocumentoId')?.dirty ||
                        validacionClientes.get('nuevoDocumentoId')?.touched)
                    "
                  >
                    {{ validation.message }}
                  </div>
                </div>
              </div>
              <small
                *ngIf="nuevoDocumentoIdNoValido"
                class="form-text text-danger animate__animated animate__heartBeat"
              ></small>
            </div>

            <!-- ENTRADA PARA EL EMAIL -->

            <div class="form-group">
              <div class="input-group">
                <span class="input-group-addon"
                  ><i class="fa fa-envelope"></i
                ></span>

                <input
                  type="email"
                  class="form-control input-lg"
                  formControlName="nuevoEmail"
                  placeholder="Ingresar email"
                />
              </div>
              <div
                *ngIf="
                  validacionClientes.controls['nuevoEmail'].invalid &&
                  (validacionClientes.controls['nuevoEmail'].dirty ||
                    validacionClientes.controls['nuevoEmail'].touched)
                "
                class="form-text text-danger"
              >
                <div
                  *ngFor="
                    let validation of user_validation_messages.nuevoCliente
                  "
                >
                  <div
                    style="font-size: smaller !important"
                    *ngIf="
                      validacionClientes
                        .get('nuevoEmail')
                        ?.hasError(validation.type) &&
                      (validacionClientes.get('nuevoEmail')?.dirty ||
                        validacionClientes.get('nuevoEmail')?.touched)
                    "
                  >
                    {{ validation.message }}
                  </div>
                </div>
              </div>
              <small
                *ngIf="nuevoEmailNoValido"
                class="form-text text-danger animate__animated animate__heartBeat"
              ></small>
            </div>

            <!-- ENTRADA PARA EL TELÉFONO -->

            <div class="form-group">
              <div class="input-group">
                <span class="input-group-addon"
                  ><i class="fa fa-phone"></i
                ></span>

                <input
                  type="text"
                  class="form-control input-lg"
                  formControlName="nuevoTelefono"
                  placeholder="Ingresar teléfono"
                  maxlength="10"
                  minlength="10"
                />
              </div>
              <div
                *ngIf="
                  validacionClientes.controls['nuevoTelefono'].invalid &&
                  (validacionClientes.controls['nuevoTelefono'].dirty ||
                    validacionClientes.controls['nuevoTelefono'].touched)
                "
                class="form-text text-danger"
              >
                <div
                  *ngFor="
                    let validation of user_validation_messages.nuevoTelefono
                  "
                >
                  <div
                    style="font-size: smaller !important"
                    *ngIf="
                      validacionClientes
                        .get('nuevoTelefono')
                        ?.hasError(validation.type) &&
                      (validacionClientes.get('nuevoTelefono')?.dirty ||
                        validacionClientes.get('nuevoTelefono')?.touched)
                    "
                  >
                    {{ validation.message }}
                  </div>
                </div>
              </div>
              <small
                *ngIf="nuevoTelefonoNoValido"
                class="form-text text-danger animate__animated animate__heartBeat"
              ></small>
            </div>

            <!-- ENTRADA PARA LA DIRECCIÓN -->

            <div class="form-group">
              <div class="input-group">
                <span class="input-group-addon"
                  ><i class="fa fa-map-marker"></i
                ></span>

                <input
                  type="text"
                  class="form-control input-lg"
                  formControlName="nuevaDireccion"
                  placeholder="Ingresar dirección"
                />
              </div>
              <div
                *ngIf="
                  validacionClientes.controls['nuevaDireccion'].invalid &&
                  (validacionClientes.controls['nuevaDireccion'].dirty ||
                    validacionClientes.controls['nuevaDireccion'].touched)
                "
                class="form-text text-danger"
              >
                <div
                  *ngFor="
                    let validation of user_validation_messages.nuevaDireccion
                  "
                >
                  <div
                    style="font-size: smaller !important"
                    *ngIf="
                      validacionClientes
                        .get('nuevaDireccion')
                        ?.hasError(validation.type) &&
                      (validacionClientes.get('nuevaDireccion')?.dirty ||
                        validacionClientes.get('nuevaDireccion')?.touched)
                    "
                  >
                    {{ validation.message }}
                  </div>
                </div>
              </div>
              <small
                *ngIf="nuevaDireccionNoValido"
                class="form-text text-danger animate__animated animate__heartBeat"
              ></small>
            </div>

            <!-- ENTRADA PARA LA FECHA DE NACIMIENTO -->

            <div class="form-group">
              <div class="input-group">
                <span class="input-group-addon"
                  ><i class="fa fa-calendar"></i
                ></span>

                <input
                  type="text"
                  class="form-control input-lg"
                  name="nuevaFechaNacimiento"
                  placeholder="Ingresar fecha nacimiento"
                  data-inputmask="'alias': 'yyyy/mm/dd'"
                  data-mask
                />
              </div>
            </div>
          </div>
        </div>

        <!--=====================================
            PIE DEL MODAL
            ======================================-->

        <div class="modal-footer">
          <button
            type="button"
            class="btn btn-default pull-left"
            data-dismiss="modal"
          >
            Salir
          </button>

          <button
            type="submit"
            class="btn btn-primary"
            [disabled]="!cuentaForm.form.valid"
            data-dismiss="modal"
          >
            Guardar cliente
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
